<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Leosac: General Configuration</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Leosac
   &#160;<span id="projectnumber">0.6.3</span>
   </div>
   <div id="projectbrief">OpenSourceAccessControl</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d4/d5d/page_general_config.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">General Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#general_config_intro">Introduction </a></li>
<li class="level1"><a href="#general_config_path_mng">Path Management </a></li>
<li class="level1"><a href="#general_instance_name">Instance Name </a></li>
<li class="level1"><a href="#general_database">Database </a><ul><li class="level2"><a href="#database_example">Example </a></li>
</ul>
</li>
<li class="level1"><a href="#general_config_save">Automatic Configuration Saving </a></li>
<li class="level1"><a href="#general_config_logger">Logger Configuration </a><ul><li class="level2"><a href="#logger_user_config">Configuration Options </a></li>
<li class="level2"><a href="#logger_example">Example </a></li>
</ul>
</li>
<li class="level1"><a href="#general_config_network">Network Configuration </a><ul><li class="level2"><a href="#network_example">Example </a></li>
</ul>
</li>
<li class="level1"><a href="#remote_control">Remote Control </a></li>
<li class="level1"><a href="#sync_source">Sync Source </a><ul><li class="level2"><a href="#sync_source_ex">Example </a></li>
</ul>
</li>
<li class="level1"><a href="#sync_dest">Sync Dest </a></li>
<li class="level1"><a href="#non_importable_module">Non Importable Module </a></li>
<li class="level1"><a href="#version">Version </a></li>
</ul>
</div>
<div class="textblock"><p>Global configuration option.</p>
<h1><a class="anchor" id="general_config_intro"></a>
Introduction </h1>
<p>Even though <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> is heavily based on modules, there are general configuration options. Those are defined in the main configuration file, outside of the <code>&lt;modules&gt;</code> and <code>&lt;/modules&gt;</code> tags.</p>
<p>Here is an overview of what we call "general configuration":</p><ul>
<li>Database configuration</li>
<li>Logger configuration</li>
<li>Network configuration</li>
<li>Remote control configuration.</li>
</ul>
<h1><a class="anchor" id="general_config_path_mng"></a>
Path Management </h1>
<p><a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> has to know 2 important paths:</p><ol type="1">
<li>The path to the factory configuration directory: this can be set with the environment variable <code>LEOSAC_FACTORY_CONFIG_DIR</code>.</li>
<li>Paths to where <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a>'s shell scripts are saved. Customizable with <code>LEOSAC_SCRIPTS_DIR</code> env variable.</li>
</ol>
<h1><a class="anchor" id="general_instance_name"></a>
Instance Name </h1>
<p>Each unit is given an <code>instance_name</code> to help identify it when running in a environment with multiple <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> system. This field is mandatory.</p><ol type="1">
<li>This <code>instance_name</code> information is never synchronized.</li>
<li>It is used to automatically prefix some configuration option: for example the <code>target</code> (door) in the auth file module. This allows easier config synchronization.</li>
</ol>
<h1><a class="anchor" id="general_database"></a>
Database </h1>
<p><a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> can work with either an SQLite or PostgreSQL database. The database is mandatory to provide support for some features. For example, the WebSocket API needs access to the database to store users, permissions, etc. Similarly, the HardwareService needs the DBService to operate.</p>
<p>The <code>database</code> tag holds various information about the database.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>type </td><td></td><td>Underlying database type. Either "sqlite" or "mysql". </td><td>YES </td></tr>
<tr>
<td>path </td><td></td><td><b>SQLite only</b>: Path to the database file. </td><td>YES if SQLite </td></tr>
<tr>
<td>username </td><td></td><td><b>PGSQL only</b>: Database username. </td><td>YES if MySQL </td></tr>
<tr>
<td>password </td><td></td><td><b>PGSQL only</b>: Password for the database user. </td><td>YES if MySQL </td></tr>
<tr>
<td>dbname </td><td></td><td><b>PGSQL only</b>: Database name to use. </td><td>YES if MySQL </td></tr>
<tr>
<td>host </td><td></td><td><b>PGSQL only</b>: Database hostname / IP. </td><td>NO </td></tr>
<tr>
<td>port </td><td></td><td><b>PGSQL only</b>: Port the database listens to </td><td>NO </td></tr>
</table>
<h2><a class="anchor" id="database_example"></a>
Example </h2>
<p>Below is an example for SQLite.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">database</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">type</span>&gt;<span class="keyword">SQLite</span>&lt;/<span class="keywordtype">type</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">path</span>&gt;<span class="keyword">leosac.sqlite</span>&lt;/<span class="keywordtype">path</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">database</span>&gt;</div></div><!-- fragment --><p>An one for PGSQL. </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">database</span>&gt;</div><div class="line">      &lt;<span class="keywordtype">type</span>&gt;<span class="keyword">pgsql</span>&lt;/<span class="keywordtype">type</span>&gt;</div><div class="line">      &lt;<span class="keywordtype">username</span>&gt;<span class="keyword">root</span>&lt;/<span class="keywordtype">username</span>&gt;</div><div class="line">      &lt;<span class="keywordtype">password</span>&gt;&lt;/<span class="keywordtype">password</span>&gt;</div><div class="line">      &lt;<span class="keywordtype">dbname</span>&gt;<span class="keyword">leosac</span>&lt;/<span class="keywordtype">dbname</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">database</span>&gt;</div></div><!-- fragment --><h1><a class="anchor" id="general_config_save"></a>
Automatic Configuration Saving </h1>
<p>There is a useful configuration option: <code>autosave</code>. When set to true, the current configuration of <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> will be saved to disk when <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> exits. It defaults to false.</p>
<h1><a class="anchor" id="general_config_logger"></a>
Logger Configuration </h1>
<p><a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> has a builtin logger for information and / or debugging purposes. It can write to syslog. It is not recommended to log DEBUG message to syslog.</p>
<h2><a class="anchor" id="logger_user_config"></a>
Configuration Options </h2>
<p>Default configuration will log everything to <code>stdout</code>. Entry with a level &gt;= <code>WARNING</code> will be written to syslog.</p>
<table class="doxtable">
<tr>
<th>Options </th><th>Description </th><th>Mandatory  </th></tr>
<tr>
<td>enable_syslog </td><td>Enable logging to syslog </td><td>NO (default to <code>true</code>) </td></tr>
<tr>
<td>enable_database</td><td>Enable logging to the configured (if any) database.</td><td>NO (default to <code>false</code>) </td></tr>
<tr>
<td>min_syslog </td><td>Minimal log entry level to write to syslog </td><td>NO (default to <code>WARNING</code>) </td></tr>
</table>
<p>Here is a list of the various log level available:</p><ul>
<li><code>DEBUG</code></li>
<li><code>INFO</code></li>
<li><code>NOTICE</code></li>
<li><code>WARNING</code></li>
<li><code>ERROR</code></li>
<li><code>CRITICAL</code></li>
<li><code>ALERT</code></li>
<li><code>EMERGENCY</code></li>
</ul>
<h2><a class="anchor" id="logger_example"></a>
Example </h2>
<p>Logger configuration takes place in the <code>&lt;kernel&gt;</code> tag. It is <b>not</b> configured as a module.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">log</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">enable_syslog</span>&gt;<span class="keyword">true</span>&lt;/<span class="keywordtype">enable_syslog</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">min_syslog</span>&gt;<span class="keyword">INFO</span>&lt;/<span class="keywordtype">min_syslog</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">log</span>&gt;</div></div><!-- fragment --><h1><a class="anchor" id="general_config_network"></a>
Network Configuration </h1>
<p><a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> can provide an abstraction to network configuration. You can configure your IP address, netmask and gateway in <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a>'s configuration file.</p>
<p>This allows the Remote Control API (or Rpleth API) to change the network configuration of the <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> unit.</p>
<p>However, if you do not plan on changing your IP address or see no use for this feature, it is recommended to use Linux tools to configure your network instead (ie, write to <code>/etc/network/interfaces</code>).</p>
<dl class="section note"><dt>Note</dt><dd>Disabling the network subsystem (with <code>&lt;enabled&gt;false&lt;/enabled&gt;</code>) doesn't disable the network. It disables the network management that <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a> does. If you want to fully disable the network, you'll have to do this at the operating system level.</dd>
<dd>
CIDR notation is not supported (see <a href="https://github.com/leosac/leosac/issues/54">#54</a>).</dd></dl>
<h2><a class="anchor" id="network_example"></a>
Example </h2>
<p>Network configuration takes place in the <code>&lt;kernel&gt;</code> tag. It is <b>not</b> configured as a module.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">network</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">enabled</span>&gt;<span class="keyword">false</span>&lt;/<span class="keywordtype">enabled</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">network</span>&gt;</div></div><!-- fragment --><p>An other example with enabled network management.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">network</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">enabled</span>&gt;<span class="keyword">true</span>&lt;/<span class="keywordtype">enabled</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">interface</span>&gt;<span class="keyword">eth0</span>&lt;/<span class="keywordtype">interface</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">dhcp</span>&gt;<span class="keyword">true</span>&lt;/<span class="keywordtype">dhcp</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">netmask</span>&gt;255.255.255.0&lt;/<span class="keywordtype">netmask</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">default_ip</span>&gt;192.168.0.18&lt;/<span class="keywordtype">default_ip</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">gateway</span>&gt;192.168.0.1&lt;/<span class="keywordtype">gateway</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">network</span>&gt;</div></div><!-- fragment --><h1><a class="anchor" id="remote_control"></a>
Remote Control </h1>
<p>The Remote Control API is more complicated than logger or network configuration, and require a more in depth description. You can find it <a class="el" href="../../d7/df1/page_remote_control.html#remote_control_main">here</a>.</p>
<h1><a class="anchor" id="sync_source"></a>
Sync Source </h1>
<p>From all these configuration options, you may want to limit which one gets exported over the network when a remote command to fetch the global configuration is received.</p>
<p>If no <code>&lt;sync_source&gt;</code> is present, export everything. Here is a list of exportable config tag:</p><ul>
<li><code>&lt;autosave&gt;</code></li>
<li><code>&lt;plugin_directories&gt;</code></li>
<li><code>&lt;log&gt;</code></li>
<li><code>&lt;network&gt;</code></li>
<li><code>&lt;remote&gt;</code></li>
<li><code>&lt;sync_dest&gt;</code></li>
</ul>
<p>Note that the <code>no_import</code> tag cannot be exported.</p>
<h2><a class="anchor" id="sync_source_ex"></a>
Example </h2>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">sync_source</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">log</span>&gt;<span class="keyword">true</span>&lt;/<span class="keywordtype">log</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">network</span>&gt;<span class="keyword">false</span>&lt;/<span class="keywordtype">network</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">remote</span>&gt;<span class="keyword">false</span>&lt;/<span class="keywordtype">remote</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">sync_source</span>&gt;</div></div><!-- fragment --><h1><a class="anchor" id="sync_dest"></a>
Sync Dest </h1>
<p>This is similar to <code>sync_source</code> but is on the receiver side. The tag set to true in <code>sync_dest</code> are the tag that will be updated with the content from the remote server. The rules are the same than <code>sync_source</code>.</p>
<h1><a class="anchor" id="non_importable_module"></a>
Non Importable Module </h1>
<p>By default all modules are synchronised when syncing configuration - be it when the Replication module runs, or when the server receive the <code>SYNC_FROM</code> remote control command. It's however possible to prevent module configuration from being added, erased or updated.</p>
<p>To do so, define a <code>&lt;no_import&gt;</code> tag in the config file.</p>
<p><b>Note</b>: The <code>&lt;no_import&gt;</code> tag will <b>NEVER</b> be synchronized from a remote server.</p>
<p><em>Security notice:</em> This is because it is not exported, not because we carefully ignore it when importing.</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">no_import</span>&gt;</div><div class="line">    &lt;<span class="keywordtype">TEST_AND_RESET</span> /&gt;</div><div class="line">    &lt;<span class="keywordtype">ANOTHER_MODULE</span> /&gt;</div><div class="line">&lt;/<span class="keywordtype">no_import</span>&gt;</div></div><!-- fragment --><p>This will have the effect of leaving alone the configuration of Test and Reset and Another Module. It will not prevent the module config from being exported.</p>
<h1><a class="anchor" id="version"></a>
Version </h1>
<p>A <code>version</code> field is configurable. This is mostly used when running a master/slave configuration. If you make a change to the configuration, and increments this <code>version</code> field, slave should automatically update their configuration. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Leosac Manual</a></li><li class="navelem"><a class="el" href="../../d9/d1d/page_doc_content.html">Documentation</a></li>
    <li class="footer">Generated on Thu Jan 25 2018 20:19:47 for Leosac by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
