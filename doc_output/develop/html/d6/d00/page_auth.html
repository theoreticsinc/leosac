<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Leosac: Authentication</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Leosac
   &#160;<span id="projectnumber">0.6.3</span>
   </div>
   <div id="projectbrief">OpenSourceAccessControl</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d6/d00/page_auth.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Authentication </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#auth_main">Authentication Documentation </a></li>
<li class="level1"><a href="#auth_intro">Introduction </a><ul><li class="level2"><a href="#auth_data_type">Authentication data type </a></li>
</ul>
</li>
<li class="level1"><a href="#auth_specc">Message Passing Specifications </a></li>
</ul>
</div>
<div class="textblock"><p>Explain how the authentication and authorization subsystem works.</p>
<h1><a class="anchor" id="auth_main"></a>
Authentication Documentation </h1>
<h1><a class="anchor" id="auth_intro"></a>
Introduction </h1>
<p>In an access control system, the authentication &amp; authorization subsystem is complex. This page aims to explain how it works in <a class="el" href="../../d6/d58/namespaceLeosac.html" title="This is the header file for a generated source file, GitSHA1.cpp. ">Leosac</a>.</p>
<p>The task of reading credentials, validating them and taking action (opening doors) is split over multiple module. This gives us more flexibility and helps keeping the code clear and relatively simple.</p>
<p>Below is a diagram that illustrate how thing works: </p><div class="image">
<img src="../../../resources/overview_auth.png" alt="Auth overview diagram"/>
</div>
 <h1>Two kinds of modules </h1>
<p>We break down the authentication &amp; authorization code in multiple parts. There are two kinds of modules:</p><ol type="1">
<li>Authentication Source module (eg <a class="el" href="../../d2/d23/page_module_wiegand.html#mod_wiegand_main">Wiegand</a>)</li>
<li>Authentication Backend module (eg <a class="el" href="../../d4/dae/page_module_authfile.html#mod_auth_file_main">Files</a>)</li>
</ol>
<h2>Authentication Source </h2>
<p>An <b>authentication source</b> module provides user-data to the system, for example a card id or a pin code. Theses modules are first in the chain of event that lead to an access control.</p>
<p>An authentication <b>shall</b> have at least one property: a name. This name will be used throughout the application to determine what device (or authentication source) triggered the events.</p>
<p>TODO: Also we need something to identify the [type](ref auth_data_type) of the data. (pin vs pin/card id vs card id vs ...)</p>
<h2>Authentication Backend </h2>
<p>An <b>authentication backend</b> module gather event from <b>authentication source</b> and check their own backend to build a profile (raw files, database, remote webservices, ...)</p>
<p>The profile is built by checking group-membership, credentials mapping, etc. The newly built profile is then queried to determine whether or not the user should be granted access.</p>
<p>In order for this to work properly, we need a decent message passing specifications.</p>
<h2><a class="anchor" id="auth_data_type"></a>
Authentication data type </h2>
<p>Data type information helps authentication backends understand messages from authentication sources. It is an enumeration value, see <a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#acab42172927988f0c2c41e4170c6fc7c">AuthSourceType</a>.</p>
<p>Currently we are lucky, we only define a few.</p>
<ol type="1">
<li><b>SIMPLE_WIEGAND</b>: This data type requires 2 frames:<ol type="a">
<li>An hexadecimal <em>string</em> that contain the card id that was read, for example: "40:a0:83:80"</li>
<li>An <em>integer</em> that holds the number of bits in the card id.</li>
</ol>
</li>
<li><b>WIEGAND_PIN</b>: Configuration mode used when we use the reader only for PIN code.<ol type="a">
<li>A <em>string</em> that contains the PIN code. Its easier to use string, because we don't know the length of the PIN code, and it may vary.</li>
</ol>
</li>
<li><b>WIEGAND_CARD_PIN</b>: This credential mode holds both a wiegand card number along with a PIN code.<ol type="a">
<li>An hexadecimal <em>string</em> that contain the card id that was read, for example: "40:a0:83:80"</li>
<li>An <em>integer</em> that holds the number of bits in the card id.</li>
<li>A <em>string</em> that contains the PIN code.</li>
</ol>
</li>
<li><b>SIMPLE_CSN</b>: A Card Serial Number in hexadecimal string format, separated by ":"<ol type="a">
<li>This Auth::SourceType requires a single frame. Example: "aa:bb:42:cd"</li>
</ol>
</li>
</ol>
<h1><a class="anchor" id="auth_specc"></a>
Message Passing Specifications </h1>
<p>Understand the <a class="el" href="../../dd/dc8/classMessageBus.html">application message bus</a> first.</p>
<p>First, a few assumptions. Authentication data from auth source may vary widely. Consider a simple pin code versus a wiegand card id. The wiegand card must holds 2 data: the value, and the number of meaningful bits. A wiegand reader can also handle PIN code + card id, augmenting complexity of the auth data.</p>
<p>Auth backend must be able to distinguish between those to handles them properly.</p>
<h3>Authentication Source</h3>
<p>Workflow for an <b>authentication source</b> module:</p><ol type="1">
<li>Having enough meaningful data that represents an authentication source (card id, pin code, fingerprint, ...) the module shall publish a message on the message bus the let others know.</li>
<li>The message shall be multiparts.<ol type="a">
<li>Its first frame must be the auth source's name prefixed by <code>S_</code>.</li>
<li>The second frame shall be the type of data. See <a class="el" href="../../d6/d00/page_auth.html#auth_data_type">this</a>.</li>
<li>Optional (but likely presents) frames that contains different data based on the <a class="el" href="../../d6/d00/page_auth.html#auth_data_type">auth data type</a></li>
</ol>
</li>
</ol>
<p>As an example, consider a message from the <a class="el" href="../../d2/d23/page_module_wiegand.html#mod_wiegand_main">wiegand module</a>, named <code>MY_WIEGAND_1</code>:</p>
<table class="doxtable">
<tr>
<th>Frame </th><th>Content </th><th>Type  </th></tr>
<tr>
<td>1 </td><td>"MY_WIEGAND_1" </td><td><code>string</code> </td></tr>
<tr>
<td>2 </td><td><code><a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#acab42172927988f0c2c41e4170c6fc7cadfc230c1a50a40fe6ced38ae2034c1ee" title="This define message formatting for data source SIMPLE_WIEGAND. ">Leosac::Auth::SourceType::SIMPLE_WIEGAND</a></code> </td><td><a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#acab42172927988f0c2c41e4170c6fc7c">AuthSourceType</a> (<code>uint8_t</code>) </td></tr>
<tr>
<td>3 </td><td>"12:af:cd:21" </td><td><code>string</code> </td></tr>
<tr>
<td>4 </td><td>26 </td><td><code>int</code> </td></tr>
</table>
<p>A second example for the <code>WIEGAND_PIN</code> auth source mode:</p>
<table class="doxtable">
<tr>
<th>Frame </th><th>Content </th><th>Type  </th></tr>
<tr>
<td>1 </td><td>"MY_WIEGAND_1" </td><td><code>string</code> </td></tr>
<tr>
<td>2 </td><td><code><a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#acab42172927988f0c2c41e4170c6fc7cad27ac48ca7deb28930fc79edb3866fa2" title="Message formatting when using a simple PIN code. ">Leosac::Auth::SourceType::WIEGAND_PIN</a></code> </td><td><a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#acab42172927988f0c2c41e4170c6fc7c">AuthSourceType</a> (<code>uint8_t</code>) </td></tr>
<tr>
<td>3 </td><td>"1234591" </td><td><code>string</code> </td></tr>
</table>
<h3>Authentication Backend</h3>
<p>Workflow for an <b>authentication backend</b> module:</p><ol type="1">
<li>Receive a message from an <b>auth source</b>.</li>
<li>Process the message, and decide whether access shall be granted or not.</li>
<li>Send a multiparts response message.<ol type="a">
<li>The first frame MUST be <code>S_{AUTH_INSTANCE_NAME}</code>.</li>
<li>The second frame shall be an <a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#a01fd31044ca7215b621bc12f7cde91a3">AccessStatus</a>.</li>
</ol>
</li>
</ol>
<table class="doxtable">
<tr>
<th>Frame </th><th>Content </th><th>Type  </th></tr>
<tr>
<td>1 </td><td>"S_MY_AUTH_SOURCE_1" </td><td><code>string</code> </td></tr>
<tr>
<td>2 </td><td><code>Leosac::Auth::AccessStatus::Granted</code> </td><td><a class="el" href="../../d0/d31/namespaceLeosac_1_1Auth.html#a01fd31044ca7215b621bc12f7cde91a3">AccessStatus</a> (<code>uint8_t</code>) </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../index.html">Leosac Manual</a></li><li class="navelem"><a class="el" href="../../d9/d1d/page_doc_content.html">Documentation</a></li>
    <li class="footer">Generated on Thu Jan 25 2018 20:19:46 for Leosac by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
