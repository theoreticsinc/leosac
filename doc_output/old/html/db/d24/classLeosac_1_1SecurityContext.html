<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Leosac: Leosac::SecurityContext Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Leosac
   &#160;<span id="projectnumber">0.6.3</span>
   </div>
   <div id="projectbrief">OpenSourceAccessControl</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d6/d58/namespaceLeosac.html">Leosac</a></li><li class="navelem"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html">SecurityContext</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="../../de/da0/classLeosac_1_1SecurityContext-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Leosac::SecurityContext Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>A <a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html" title="A SecurityContext is used to query permission while doing an operation. ">SecurityContext</a> is used to query permission while doing an operation.  
 <a href="../../db/d24/classLeosac_1_1SecurityContext.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="../../d1/d3e/SecurityContext_8hpp_source.html">SecurityContext.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Leosac::SecurityContext:</div>
<div class="dyncontent">
<div class="center"><img src="../../d9/d60/classLeosac_1_1SecurityContext__inherit__graph.png" border="0" usemap="#Leosac_1_1SecurityContext_inherit__map" alt="Inheritance graph"/></div>
<map name="Leosac_1_1SecurityContext_inherit__map" id="Leosac_1_1SecurityContext_inherit__map">
<area shape="rect" id="node2" href="../../dd/dc0/classLeosac_1_1SystemSecurityContext.html" title="A security context for system operation. " alt="" coords="5,80,232,107"/>
<area shape="rect" id="node3" href="../../da/d85/classLeosac_1_1UserSecurityContext.html" title="A SecurityContext object for users. " alt="" coords="257,80,463,107"/>
<area shape="rect" id="node4" href="../../d2/d3e/classLeosac_1_1NullSecurityContext.html" title="A SecurityContext with no permission. " alt="" coords="259,155,461,181"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d5c/structLeosac_1_1SecurityContext_1_1AccessPointActionParam.html">AccessPointActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">union &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d69/structLeosac_1_1SecurityContext_1_1CredentialActionParam.html">CredentialActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de9/structLeosac_1_1SecurityContext_1_1DoorActionParam.html">DoorActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d50/structLeosac_1_1SecurityContext_1_1GroupActionParam.html">GroupActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/df1/structLeosac_1_1SecurityContext_1_1MembershipActionParam.html">MembershipActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/dd0/structLeosac_1_1SecurityContext_1_1ScheduleActionParam.html">ScheduleActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/dbb/structLeosac_1_1SecurityContext_1_1UserActionParam.html">UserActionParam</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ab2c95b8d870b96bad52bb5d3026300ee"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a> { <br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea858b558b08359b23f3d25f58ecd50e38">Action::IS_ADMIN</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeac8a72178f3d5f13b6d327d4573838534">Action::IS_MANAGER</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaa92afa63584cc2a62d2dd2996727b2c5">Action::USER_CREATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea99b993a751e3d9cb8a12c725b2077be5">Action::USER_READ</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea8b0df3a6504784953b2a4309e7608202">Action::USER_READ_EMAIL</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea1e80c8765d49f66f131d97c4a4b8be17">Action::USER_UPDATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea897207a36c411d736947052219624b72">Action::USER_CHANGE_PASSWORD</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea2071f9920148fa981e21d914ae724ea7">Action::USER_UPDATE_RANK</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea6f640530df7a5ebe22c3f009ed65f4da">Action::USER_MANAGE_VALIDITY</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea6bd35e9e6a3014a4bf7fbfc650471b5d">Action::USER_DELETE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaa9f9694169963af7096ae421df5025ce">Action::GROUP_CREATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea18726f2e5a49abcf2f408ccf9e9940df">Action::GROUP_READ</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaf08bd163bef735c856e9131fa9875347">Action::GROUP_UPDATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea9f96134149284aad5005a993efa162ad">Action::GROUP_DELETE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea58bc40563913b8c1e89a1aaff2ac08ac">Action::GROUP_SEARCH</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeacc1aaa149548f53c86807da0bfa66250">Action::GROUP_LIST_MEMBERSHIP</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea5b681462a2425ab0db8f826fc672fcac">Action::GROUP_MEMBERSHIP_JOINED</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea0b0e80661997c1d0b9492bab4fdb86e4">Action::GROUP_MEMBERSHIP_LEFT</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeae17d5a46e46b3bc0508f3d150e850d84">Action::MEMBERSHIP_READ</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea8350bf1de1344bdceb3e64079a76ab29">Action::CREDENTIAL_READ</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea50948e94cc101ba40ed166740c3446a8">Action::CREDENTIAL_UPDATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea01eaa7c0c38ca2e328649408e5817718">Action::CREDENTIAL_CREATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea0eebc6f26a37289ad061e95e41f42d61">Action::CREDENTIAL_DELETE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea3b2781bee87f12add35306e98603c424">Action::SCHEDULE_READ</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeafd625fb8b398e45ad779ac00e173f567">Action::SCHEDULE_UPDATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea24f9958f8631d4b76ff79b1d22402928">Action::SCHEDULE_CREATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeac23b07288e17dbcde54263fd62581b10">Action::SCHEDULE_DELETE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea2e8c4a9ec8bc18eca18303d75df8ad55">Action::SCHEDULE_SEARCH</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea103a14ddb173a8a840f6b563f669469f">Action::DOOR_READ</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaa2fd9d740b8a7b92e94c950aabed698a">Action::DOOR_UPDATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea80ef9322e45631667da56fa652dae38a">Action::DOOR_CREATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaef4d1b0c62d51e964725248268991cbb">Action::DOOR_DELETE</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea48bd3aeee3aa2b6c7303ac4e9921a9d3">Action::DOOR_SEARCH</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeac184abf7949d6135ec2e36ab346a8664">Action::ACCESS_POINT_READ</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaf96ae97de49b44e031e6e16023d48f17">Action::ACCESS_POINT_CREATE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea9460e06456422545937ea3146acc3d3c">Action::ACCESS_POINT_UPDATE</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeab1adab6e1f1772b25e5230110902b682">Action::ACCESS_POINT_DELETE</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea52fcf5bc0d2f6ba7ac5eb04458f3513e">Action::ACCESS_POINT_SEARCH</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea3ebd9bf98a56884f690a9d027836e443">Action::SMTP_GETCONFIG</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea7c72ea265b8d1d0b269aa99206dc2c8c">Action::SMTP_SETCONFIG</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeac8ddd577a88e80b2ff0217e890b59790">Action::SMTP_SENDMAIL</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea45666863ebb05a78c3dd224a52036555">Action::LOG_READ</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eea96b4630e4abc6d95b55975271bd76e6f">Action::AUDIT_READ</a>, 
<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeae76e3175c4c546a4fab4dd109ee4f287">Action::AUDIT_READ_FULL</a>, 
<br />
&#160;&#160;<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300eeaffb80f38871b43e4ab3ef5972a38e7d3">Action::ACCESS_OVERVIEW</a>
<br />
 }</td></tr>
<tr class="separator:ab2c95b8d870b96bad52bb5d3026300ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9c4d223d9ad26d270ec13ae456c5009c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#a9c4d223d9ad26d270ec13ae456c5009c">SecurityContext</a> (<a class="el" href="../../d6/d58/namespaceLeosac.html#a8f512d8fa4eca0f099214bfdc1b3c392">DBServicePtr</a> dbsrv)</td></tr>
<tr class="separator:a9c4d223d9ad26d270ec13ae456c5009c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc35a2c49c52e3760714e844fa6ad10"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#acdc35a2c49c52e3760714e844fa6ad10">check_permission</a> (<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a> a, const <a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a> &amp;ap) const</td></tr>
<tr class="memdesc:acdc35a2c49c52e3760714e844fa6ad10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for the permission to perform action <code>a</code> with parameters <code>ap</code>.  <a href="#acdc35a2c49c52e3760714e844fa6ad10">More...</a><br /></td></tr>
<tr class="separator:acdc35a2c49c52e3760714e844fa6ad10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b11fe6cdd313366b53686a6808f8f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ae3b11fe6cdd313366b53686a6808f8f6">check_permission</a> (<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a> a) const</td></tr>
<tr class="memdesc:ae3b11fe6cdd313366b53686a6808f8f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for the permission to perform a given action.  <a href="#ae3b11fe6cdd313366b53686a6808f8f6">More...</a><br /></td></tr>
<tr class="separator:ae3b11fe6cdd313366b53686a6808f8f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab1a8b9eef190f830d626ade3cc4bdbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#aab1a8b9eef190f830d626ade3cc4bdbf">enforce_permission</a> (<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a> a, const <a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a> &amp;ap) const</td></tr>
<tr class="memdesc:aab1a8b9eef190f830d626ade3cc4bdbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similar to <a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#acdc35a2c49c52e3760714e844fa6ad10" title="Check for the permission to perform action a with parameters ap. ">check_permission()</a>, but throws is the permission is denied.  <a href="#aab1a8b9eef190f830d626ade3cc4bdbf">More...</a><br /></td></tr>
<tr class="separator:aab1a8b9eef190f830d626ade3cc4bdbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11f939bdae06c8b00c40bb33fc67508"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab11f939bdae06c8b00c40bb33fc67508">enforce_permission</a> (<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a> a) const</td></tr>
<tr class="memdesc:ab11f939bdae06c8b00c40bb33fc67508"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure that we have the permission to perform action <code>a</code>, otherwise throws.  <a href="#ab11f939bdae06c8b00c40bb33fc67508">More...</a><br /></td></tr>
<tr class="separator:ab11f939bdae06c8b00c40bb33fc67508"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac011df2f8dd0e48744712e144f1522d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d58/namespaceLeosac.html#a8f512d8fa4eca0f099214bfdc1b3c392">DBServicePtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ac011df2f8dd0e48744712e144f1522d3">dbsrv_</a></td></tr>
<tr class="separator:ac011df2f8dd0e48744712e144f1522d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a71a42020ca2d2078faf867d1ca2981ef"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#a71a42020ca2d2078faf867d1ca2981ef">check_permission_impl</a> (<a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a> a, const <a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a> &amp;ap) const =0</td></tr>
<tr class="memdesc:a71a42020ca2d2078faf867d1ca2981ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reimplement this method to provide permission checking.  <a href="#a71a42020ca2d2078faf867d1ca2981ef">More...</a><br /></td></tr>
<tr class="separator:a71a42020ca2d2078faf867d1ca2981ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A <a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html" title="A SecurityContext is used to query permission while doing an operation. ">SecurityContext</a> is used to query permission while doing an operation. </p>
<p>For example, JSON serializers could use a <a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html" title="A SecurityContext is used to query permission while doing an operation. ">SecurityContext</a> to determine what to serialize.</p>
<p>todo: fix doc </p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="ab2c95b8d870b96bad52bb5d3026300ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c95b8d870b96bad52bb5d3026300ee">&sect;&nbsp;</a></span>Action</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Leosac::SecurityContext::Action</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea858b558b08359b23f3d25f58ecd50e38"></a>IS_ADMIN&#160;</td><td class="fielddoc"><p>A workaround permission that requires the user to be administrator. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeac8a72178f3d5f13b6d327d4573838534"></a>IS_MANAGER&#160;</td><td class="fielddoc"><p>Requires that the user be at least manager. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaa92afa63584cc2a62d2dd2996727b2c5"></a>USER_CREATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea99b993a751e3d9cb8a12c725b2077be5"></a>USER_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea8b0df3a6504784953b2a4309e7608202"></a>USER_READ_EMAIL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea1e80c8765d49f66f131d97c4a4b8be17"></a>USER_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea897207a36c411d736947052219624b72"></a>USER_CHANGE_PASSWORD&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea2071f9920148fa981e21d914ae724ea7"></a>USER_UPDATE_RANK&#160;</td><td class="fielddoc"><p>Editing rank means being able to become administrator. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea6f640530df7a5ebe22c3f009ed65f4da"></a>USER_MANAGE_VALIDITY&#160;</td><td class="fielddoc"><p>Can we enable/disable the user or change its validity period ? </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea6bd35e9e6a3014a4bf7fbfc650471b5d"></a>USER_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaa9f9694169963af7096ae421df5025ce"></a>GROUP_CREATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea18726f2e5a49abcf2f408ccf9e9940df"></a>GROUP_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaf08bd163bef735c856e9131fa9875347"></a>GROUP_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea9f96134149284aad5005a993efa162ad"></a>GROUP_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea58bc40563913b8c1e89a1aaff2ac08ac"></a>GROUP_SEARCH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeacc1aaa149548f53c86807da0bfa66250"></a>GROUP_LIST_MEMBERSHIP&#160;</td><td class="fielddoc"><p>Ability to list member of a group. </p>
<p>The ability to list membership gives USER_READ access against the user whose membership is listed. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea5b681462a2425ab0db8f826fc672fcac"></a>GROUP_MEMBERSHIP_JOINED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea0b0e80661997c1d0b9492bab4fdb86e4"></a>GROUP_MEMBERSHIP_LEFT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeae17d5a46e46b3bc0508f3d150e850d84"></a>MEMBERSHIP_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea8350bf1de1344bdceb3e64079a76ab29"></a>CREDENTIAL_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea50948e94cc101ba40ed166740c3446a8"></a>CREDENTIAL_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea01eaa7c0c38ca2e328649408e5817718"></a>CREDENTIAL_CREATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea0eebc6f26a37289ad061e95e41f42d61"></a>CREDENTIAL_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea3b2781bee87f12add35306e98603c424"></a>SCHEDULE_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeafd625fb8b398e45ad779ac00e173f567"></a>SCHEDULE_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea24f9958f8631d4b76ff79b1d22402928"></a>SCHEDULE_CREATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeac23b07288e17dbcde54263fd62581b10"></a>SCHEDULE_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea2e8c4a9ec8bc18eca18303d75df8ad55"></a>SCHEDULE_SEARCH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea103a14ddb173a8a840f6b563f669469f"></a>DOOR_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaa2fd9d740b8a7b92e94c950aabed698a"></a>DOOR_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea80ef9322e45631667da56fa652dae38a"></a>DOOR_CREATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaef4d1b0c62d51e964725248268991cbb"></a>DOOR_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea48bd3aeee3aa2b6c7303ac4e9921a9d3"></a>DOOR_SEARCH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeac184abf7949d6135ec2e36ab346a8664"></a>ACCESS_POINT_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaf96ae97de49b44e031e6e16023d48f17"></a>ACCESS_POINT_CREATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea9460e06456422545937ea3146acc3d3c"></a>ACCESS_POINT_UPDATE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeab1adab6e1f1772b25e5230110902b682"></a>ACCESS_POINT_DELETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea52fcf5bc0d2f6ba7ac5eb04458f3513e"></a>ACCESS_POINT_SEARCH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea3ebd9bf98a56884f690a9d027836e443"></a>SMTP_GETCONFIG&#160;</td><td class="fielddoc"><p>Retrieve SMTP configuration. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea7c72ea265b8d1d0b269aa99206dc2c8c"></a>SMTP_SETCONFIG&#160;</td><td class="fielddoc"><p>Edit the SMTP configuration. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeac8ddd577a88e80b2ff0217e890b59790"></a>SMTP_SENDMAIL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea45666863ebb05a78c3dd224a52036555"></a>LOG_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eea96b4630e4abc6d95b55975271bd76e6f"></a>AUDIT_READ&#160;</td><td class="fielddoc"><p>Read the audit log. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeae76e3175c4c546a4fab4dd109ee4f287"></a>AUDIT_READ_FULL&#160;</td><td class="fielddoc"><p>Read the audit log and access additional information, such as the JSON "before" and "after" field. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab2c95b8d870b96bad52bb5d3026300eeaffb80f38871b43e4ab3ef5972a38e7d3"></a>ACCESS_OVERVIEW&#160;</td><td class="fielddoc"><p>Overview of users/doors access permission. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a9c4d223d9ad26d270ec13ae456c5009c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c4d223d9ad26d270ec13ae456c5009c">&sect;&nbsp;</a></span>SecurityContext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SecurityContext::SecurityContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d58/namespaceLeosac.html#a8f512d8fa4eca0f099214bfdc1b3c392">DBServicePtr</a>&#160;</td>
          <td class="paramname"><em>dbsrv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="acdc35a2c49c52e3760714e844fa6ad10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc35a2c49c52e3760714e844fa6ad10">&sect;&nbsp;</a></span>check_permission() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool SecurityContext::check_permission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">SecurityContext::Action</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a> &amp;&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check for the permission to perform action <code>a</code> with parameters <code>ap</code>. </p>
<p>Returns true if the permission is granted, false otherwise. </p>

</div>
</div>
<a id="ae3b11fe6cdd313366b53686a6808f8f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b11fe6cdd313366b53686a6808f8f6">&sect;&nbsp;</a></span>check_permission() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SecurityContext::check_permission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">SecurityContext::Action</a>&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check for the permission to perform a given action. </p>
<dl class="section return"><dt>Returns</dt><dd>true if permission is granted, false otherwise. </dd></dl>

</div>
</div>
<a id="a71a42020ca2d2078faf867d1ca2981ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71a42020ca2d2078faf867d1ca2981ef">&sect;&nbsp;</a></span>check_permission_impl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool Leosac::SecurityContext::check_permission_impl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">Action</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a> &amp;&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplement this method to provide permission checking. </p>

<p>Implemented in <a class="el" href="../../dd/dc0/classLeosac_1_1SystemSecurityContext.html#a9607087865b304936b55775ea8aadabc">Leosac::SystemSecurityContext</a>, <a class="el" href="../../d2/d3e/classLeosac_1_1NullSecurityContext.html#a890382657daee747e3901fae801a1df6">Leosac::NullSecurityContext</a>, and <a class="el" href="../../da/d85/classLeosac_1_1UserSecurityContext.html#a2c05e4f3476486f79aae63b2f6b9013d">Leosac::UserSecurityContext</a>.</p>

</div>
</div>
<a id="aab1a8b9eef190f830d626ade3cc4bdbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab1a8b9eef190f830d626ade3cc4bdbf">&sect;&nbsp;</a></span>enforce_permission() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SecurityContext::enforce_permission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">SecurityContext::Action</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/de8/unionLeosac_1_1SecurityContext_1_1ActionParam.html">ActionParam</a> &amp;&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Similar to <a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#acdc35a2c49c52e3760714e844fa6ad10" title="Check for the permission to perform action a with parameters ap. ">check_permission()</a>, but throws is the permission is denied. </p>

</div>
</div>
<a id="ab11f939bdae06c8b00c40bb33fc67508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11f939bdae06c8b00c40bb33fc67508">&sect;&nbsp;</a></span>enforce_permission() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SecurityContext::enforce_permission </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/d24/classLeosac_1_1SecurityContext.html#ab2c95b8d870b96bad52bb5d3026300ee">SecurityContext::Action</a>&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make sure that we have the permission to perform action <code>a</code>, otherwise throws. </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac011df2f8dd0e48744712e144f1522d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac011df2f8dd0e48744712e144f1522d3">&sect;&nbsp;</a></span>dbsrv_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d58/namespaceLeosac.html#a8f512d8fa4eca0f099214bfdc1b3c392">DBServicePtr</a> Leosac::SecurityContext::dbsrv_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/core/<a class="el" href="../../d1/d3e/SecurityContext_8hpp_source.html">SecurityContext.hpp</a></li>
<li>src/core/<a class="el" href="../../db/dc2/SecurityContext_8cpp.html">SecurityContext.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 22 2016 14:36:37 for Leosac by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
